<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Markov Chains 101 | </title> <meta name="description" content=" post 8 "> <meta name="keywords" content="Markov, Chains, pebble, game, chains, chain,introduction"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Jerome Dinal Herath"> <meta property="article:section" content=""> <meta property="article:tag" content="Markov, Chains, pebble, game, chains, chain,introduction"> <meta property="article:published_time" content="2018-01-15 00:00:00 -0800"> <meta property="og:url" content="http://dinalherath.com/2018/Markov-Chains/"> <meta property="og:title" content=" Markov Chains 101 | "> <meta property="og:image" content="http://dinalherath.com"> <meta property="og:description" content=" post 8 "> <meta property="og:site_name" content="Jerome Dinal Herath"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content=""> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" Markov Chains 101 | "> <meta name="twitter:description" content=" post 8 "> <meta name="twitter:image:src" content="http://dinalherath.com"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Markov Chains 101 | "> <meta itemprop="description" content=" post 8 "> <meta itemprop="image" content="http://dinalherath.com"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/font-awesome.min.css"> <!-- Canonical link tag --> <link rel="canonical" href="http://dinalherath.com/2018/Markov-Chains/"> <link rel="alternate" type="application/rss+xml" title="" href="http://dinalherath.com/feed.xml"> <script type="text/javascript"> var disqus_shortname = ''; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'G-JMGDT16E1T']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/"><span></span></a></h1> <ul class="navbar"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about me">About</a></li> <!-- <li><a href="/Resume.pdf">Resume</a></li> --> <!-- <li><a href="/resume">Resume</a></li>--> <!--<li><a href="/contact">Contact</a></li>--> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <p class="post-meta"><time datetime="2018-01-15T00:00:00-08:00" itemprop="datePublished">Jan 15, 2018</time></p> <h1 class="post-title" itemprop="name headline">Markov Chains 101</h1> </header> <div class="post-content" itemprop="articleBody"> <p><img src="https://raw.githubusercontent.com/dherath/WebsiteMaterial/master/2018/Post_8_MarkovCHains/first_image.jpeg" alt="markov-image" height="300px" /></p> <p>Hello Everyone!! in todays post I thought of writing an introduction for <a href="https://en.wikipedia.org/wiki/Markov_chain" target="blank">Markov Chains</a>. Simply put, Markov chains are used to model systems that change randomly where a <em>current state</em> is only dependent on the <em>previous state</em>.(<em>I’ll explain what states are in a minute</em>) In fact, its a pretty powerful technique used in fields ranging from <strong>computer networks</strong> to <strong>statistical physics</strong>. I’ll explain the basics of Markov chains using a simple example called the <em>pebble game</em> as illustrated above.</p> <p>Now imagine we have a 3x3 grid just like the image above, with the <strong>black dot</strong> being a pebble. At each instance in time a person picks the pebble up and tries to throw to some other directly linked cell randomly.(Note that throwing the pebble to diagonal cells is not possible) The image below shows the three types of throws possible:</p> <ul> <li><strong><code class="language-plaintext highlighter-rouge">config (a) :</code></strong> The pebble is at the corner, So theres only two positions it can be thrown to.The pebble can’t be thrown up or to the left.</li> <li><strong><code class="language-plaintext highlighter-rouge">config (b) :</code></strong> The pebble has three possible cells to be thrown to.The pebble can’t be thrown to the left.</li> <li><strong><code class="language-plaintext highlighter-rouge">config (c) :</code></strong> The pebble can be thrown in all directions.</li> </ul> <p><img src="https://raw.githubusercontent.com/dherath/WebsiteMaterial/master/2018/Post_8_MarkovCHains/second_image.jpeg" alt="transitions" /></p> <p>So the question is, <em><code class="language-plaintext highlighter-rouge">lets say at each time step someone picks the pebble and throws to an adjacent cell and keeps on doing it. After 10,000 iterations of the process where would the pebble likely be? OR whats the probability of some cell having the pebble, provided this was done for a long time?</code></em> Now intuitively since there are 9 cells, and the person is going to keep on throwing the pebble in this space for a long time we can make a guess that the probability of finding this pebble in any cell is equally likely, i.e the probability will be \(\frac{1}{9}\). This is actually the correct result, but there might be problems so complex that getting these sort of insights might not be as intuitive, and that’s where this technique truly shines.</p> <p>There are two main steps in defining Markovian models, the 1st is to <strong>define the states</strong> &amp; the second is to <strong>populate whats called a transition matrix</strong>. Both of which I’ll go through below.</p> <h3 id="states">States</h3> <p>Before diving into the technique itself, there are some things called <code class="language-plaintext highlighter-rouge">states</code> that must be defined.</p> <blockquote> <p><strong>States</strong> refer to all the possible configurations of the system.</p> </blockquote> <p>In our example, states refer to the cell position of the pebble at a given time instance. If you look at the figure again I’ve drawn an image with circles labeled <strong>A-I</strong>, these labels refer to the different cell locations the pebble could be in. Furthermore, I’ve also drawn arrows, these arrows represent the possible transitions from one state(cell) to another. That image corresponds to all the possible things that could happen in this system of ours, and by definition nothing beyond those transitions should occur.</p> <p>Lets take the initial state <strong>A</strong>, from this location if the pebble is to be thrown there are three possibilities,</p> <ol> <li>A transition from A to B</li> <li>A transition from A to D</li> <li>No throw is possible up or to the left, therefore a transition from A to A</li> </ol> <p>Similarly, the image represents all transitions in all states whom fall under the basic configurations explained in <strong>(a), (b) &amp; (c)</strong>. Note that it’s impossible to throw the pebble from A to E or from A to F, so there is no arrow corresponding to that.</p> <blockquote> <p>Figuring out the states of your problem is the hard part. Because there is not a set way in defining those, and it all comes down to how you see the problem. As you’ll see in the section below what comes after that is way more simpler.</p> </blockquote> <h3 id="the-transition-matrix">The transition matrix</h3> <p>Now that we have our states defined, the second problem is the transitions. It’s all nice that our figure has arrows pointing to what might happen next. But <em>which of those possibilities actually happen?</em> The thing to remember here is our entire system evolves randomly with time. Any of the state transitions could happen at some instance. Therefore <strong>the transitions aren’t deterministic rather they are probabilistic</strong>. Meaning there is a probability value associated with each transition from one state to another.</p> <p>Ok, now how do we get those probabilities. First of all since the throws are done randomly and independently of each other. <strong>config (c)</strong> shows the best possible case where a pebble could be thrown in all four directions. Since any of these transitions is equally likely, The probability of moving from state <strong>E</strong> to either <strong>F, B, D, H</strong> is \(\frac{1}{4}\) (\(P_{EF} = P_{EB} = P_{ED} = P_{EH} = \frac{1}{4}\)). However, when considering <strong>configs (a) &amp; (b)</strong> the pebble cannot be thrown in all directions. Therefore the probabilities for those impossible throws gets added on to a <em><code class="language-plaintext highlighter-rouge">special transition probability</code></em> namely \(P_{AA},~P_{DD}\) and vice-versa. According to this logic the probabilities for <strong>config (a) &amp; (b)</strong> would be \(P_{AA}=\frac{1}{2},~P_{AB}=P_{AD}=\frac{1}{4}\) and \(P_{DD} = P_{DA} = P_{DE} = P_{DG} = \frac{1}{4}\) respectively. All these probability values can be represented in matrix form, and that’s called a <strong><em>transition matrix</em>(\(\mathbb{P}\))</strong>.</p> <p>\begin{equation} \mathbb{P}=\begin{pmatrix} P_{AA} &amp; P_{AB} &amp; P_{AC} &amp; P_{AD} &amp; P_{AE} &amp; P_{AF} &amp; P_{AG} &amp; P_{AH} &amp; P_{AI} \\ P_{BA} &amp; P_{BB} &amp; P_{BC} &amp; P_{BD} &amp; P_{BE} &amp; P_{BF} &amp; P_{BG} &amp; P_{BH} &amp; P_{BI} \\ P_{CA} &amp; P_{CB} &amp; P_{CC} &amp; P_{CD} &amp; P_{CE} &amp; P_{CF} &amp; P_{CG} &amp; P_{CH} &amp; P_{CI} \\ P_{DA} &amp; P_{DB} &amp; P_{DC} &amp; P_{DD} &amp; P_{DE} &amp; P_{DF} &amp; P_{DG} &amp; P_{DH} &amp; P_{DI} \\ P_{EA} &amp; P_{EB} &amp; P_{EC} &amp; P_{ED} &amp; P_{EE} &amp; P_{EF} &amp; P_{EG} &amp; P_{EH} &amp; P_{EI} \\ P_{FA} &amp; P_{FB} &amp; P_{FC} &amp; P_{FD} &amp; P_{FE} &amp; P_{FF} &amp; P_{FG} &amp; P_{FH} &amp; P_{FI} \\ P_{GA} &amp; P_{GB} &amp; P_{GC} &amp; P_{GD} &amp; P_{GE} &amp; P_{GF} &amp; P_{GG} &amp; P_{GH} &amp; P_{GI} \\ P_{HA} &amp; P_{HB} &amp; P_{HC} &amp; P_{HD} &amp; P_{HE} &amp; P_{HF} &amp; P_{HG} &amp; P_{HH} &amp; P_{HI} \\ P_{IA} &amp; P_{IB} &amp; P_{IC} &amp; P_{ID} &amp; P_{IE} &amp; P_{IF} &amp; P_{IG} &amp; P_{IH} &amp; P_{II} \\ \end{pmatrix}\<br /> \end{equation} By substitution of values, \begin{equation} \mathbb{P}=\begin{pmatrix} \frac{1}{2} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{4} &amp; \frac{1}{2} &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 \\ \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 \\ 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{4} \\ 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{2} &amp; \frac{1}{4} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{2} \\ \end{pmatrix} \end{equation}</p> <p>Note that the summation of probabilities at each row equals to 1 &amp; for transitions that aren’t possible the value in the matrix is 0. Now that we have this matrix we can use it to calculate the probabilities of being in some state after a given set of iterations. lets consider \(\alpha_{t}\) as the probability distribution of the pebble at time t. i.e \(\alpha_{t} = (P_A,P_B,P_C,P_D,P_E,P_F,P_G,P_H,P_I)\). Therefore at t=0, since the pebble is at state A, \(\alpha_{t=0}=(1,0,0,0,0,0,0,0,0)\).</p> <p>The following method is used to calculate the probability distribution at some t.</p> <blockquote> \[\alpha_{t} = \alpha_{t-1}.\mathbb{P}\] </blockquote> <p>Then for t=1, \begin{aligned} \alpha_{t=1} &amp;= \alpha_{t=0}. \mathbb{P} \<br /> \alpha_{t=1} &amp;=(1~0~0~0~0~0~0~0~0).\begin{pmatrix} \frac{1}{2} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{4} &amp; \frac{1}{2} &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; 0 \\ \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; 0 \\ 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{4} \\ 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; 0 &amp; \frac{1}{2} &amp; \frac{1}{4} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{4} &amp; 0 &amp; \frac{1}{4} &amp; \frac{1}{2} \\ \end{pmatrix} \<br /> \alpha_{t=1} &amp;=(\frac{1}{2}~\frac{1}{4}~0~\frac{1}{4}~0~0~0~0~0) \end{aligned}</p> <p>Similarly, this process can be carried out for any given number of steps. Now, what about our earlier guess of \(\frac{1}{9}\) . This value is called the <strong>steady state probability</strong> value. By definition it’s the probability of being in a specific state provided that infinitely many iterations have taken place. The easiest way to obtain that is to convolve the equation above many times over OR simply computing a large power of \(\mathbb{P}\). Therefore simply \(\mathbb{P}^{x\rightarrow\infty}=\frac{1}{9}\) for all the states. So there you go, a somewhat simple introduction to Markov Chains. If you want to learn more about this I highly recommend the book <a href="https://www.amazon.com/Introduction-Probability-Models-Eleventh-Sheldon/dp/0124079482/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1516069838&amp;sr=1-1&amp;keywords=introduction+to+probability+models+ross" target="black">Introduction to Probability Models</a>.</p> <h5 id="so-until-next-time">So until next time,</h5> <h5 id="cheers">Cheers!</h5> <p><strong>Next: <a href="http://dinalherath.com/2018/Linked-Lists/">Finding cycles in linked lists</a></strong> <br /> <strong>Prev: <a href="http://dinalherath.com/2017/Proving-Correctness-of-Algorithms/">Proving correctness of Algorithms</a></strong></p> <aside class="share"> <p>If you liked this article and think others should read it, please <a href="http://twitter.com/share?text=Markov Chains 101&amp;url=http://dinalherath.com/2018/Markov-Chains/&amp;via=" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">share it on Twitter <i class="fa fa-twitter" aria-hidden="true" style="color:#00aced"></i></a> or <a href='https://www.facebook.com/sharer/sharer.php?u='+url; onclick="window.open(this.href, 'sharer', 'toolbar=0,status=0,width=550,height=235');return false;">Facebook <i class="fa fa-facebook-square" aria-hidden="true" style="color:#3b5998"></i></a>.</p> </aside> </div> </article> <!-- --> <footer class="site-footer"> <!--<link rel="stylesheet" href="/assets/icons/academicons-1.8.0/css/academicons.css"/>--> <div class="container"> <small class="block"><!--&lt;/&gt; <a href="http://github.com/heiswayi/thinkspace" title="a minimalist Jekyll theme for technical writing">Thinkspace theme</a> by <a href="http://heiswayi.github.io">Heiswayi Nrird</a>. |--><i class="fa fa-copyright"></i> 2017-2022 Jerome Dinal Herath</small> <!-- <a href="mailto:dinal.bing@gmail.com"><i class="fa fa-envelope" style="font-size:21px;color:#F15B3D;"></i></a> --> <!-- <a href="https://www.facebook.com/dinalHerath" target="_blank"><i class="fa fa-facebook-square" style="font-size:22px;color:#F15B3D"></i></a> --> <a href="https://github.com/dherath" target="blank"><i class="fa fa-github-square" style="font-size:22px;color:#F15B3D"></i></a> <a href="https://www.linkedin.com/in/jerome-dinal-herath-bba3b0148/" target="blank"><i class="fa fa-linkedin-square" style="font-size:22px;color:#F15B3D"></i></a> <a href="https://scholar.google.com/citations?user=vNtiUMwAAAAJ&hl=en" target="blank"><i class="fa fa-google" style="font-size:22px;color:#F15B3D"></i></a> <!-- <a href="/feed.xml" target="_blank"><i class="fa fa-rss-square" style="font-size:22px;color:#F15B3D"></i></a> --> <!--<a href="https://www.researchgate.net/profile/Jerome_Dinal_Herath" target="blank"> <i style="font-size:20px;color:#F15B3D;font-weight:bold;"> RG </i></a> --> </div> </footer> </main> </body> </html>
