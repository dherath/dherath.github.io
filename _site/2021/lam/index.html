<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Fooling AI-based System Log Anomaly Detection | </title> <meta name="description" content=" post 15 "> <meta name="keywords" content="distributed, system, logs, adversarial, attack, LAM, evasion, log, anomaly, mask, Log-Anomaly-Mask, deep learning, machine learning, anomaly detection, DeepLog, AutoEncoder"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Jerome Dinal Herath"> <meta property="article:section" content=""> <meta property="article:tag" content="distributed, system, logs, adversarial, attack, LAM, evasion, log, anomaly, mask, Log-Anomaly-Mask, deep learning, machine learning, anomaly detection, DeepLog, AutoEncoder"> <meta property="article:published_time" content="2021-12-15 00:00:00 -0800"> <meta property="og:url" content="http://dinalherath.com/2021/lam/"> <meta property="og:title" content=" Fooling AI-based System Log Anomaly Detection | "> <meta property="og:image" content="http://dinalherath.com"> <meta property="og:description" content=" post 15 "> <meta property="og:site_name" content="Jerome Dinal Herath"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content=""> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" Fooling AI-based System Log Anomaly Detection | "> <meta name="twitter:description" content=" post 15 "> <meta name="twitter:image:src" content="http://dinalherath.com"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Fooling AI-based System Log Anomaly Detection | "> <meta itemprop="description" content=" post 15 "> <meta itemprop="image" content="http://dinalherath.com"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/font-awesome.min.css"> <!-- Canonical link tag --> <link rel="canonical" href="http://dinalherath.com/2021/lam/"> <link rel="alternate" type="application/rss+xml" title="" href="http://dinalherath.com/feed.xml"> <script type="text/javascript"> var disqus_shortname = ''; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-99988883-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/"><span></span></a></h1> <ul class="navbar"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about me">About</a></li> <!-- <li><a href="/Resume.pdf">Resume</a></li> --> <!-- <li><a href="/resume">Resume</a></li>--> <!--<li><a href="/contact">Contact</a></li>--> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <p class="post-meta"><time datetime="2021-12-15T00:00:00-08:00" itemprop="datePublished">Dec 15, 2021</time></p> <h1 class="post-title" itemprop="name headline">Fooling AI-based System Log Anomaly Detection</h1> </header> <div class="post-content" itemprop="articleBody"> <p>Hi All!! today I will be writing about a piece of research I completed as part of my PhD. The premise of this work revolves around a popular sub-field in machine learning called, <a href="https://en.wikipedia.org/wiki/Adversarial_machine_learning">adversarial machine learning</a>. It’s no surprise that machine learning and deep learning models are capable of accomplishing a varying range of real-world complex tasks, from image recognition, time series prediction and playing massive multiplayer games. However, in recent years researchers have shown that machine/deep learning models can be <strong>fooled</strong>.</p> <p><img src="/material/2021/post_15/adv_attack.jpeg?raw=true" alt="attack-image" width="640px" /> <br /></p> <p>The image above is a prime example for that. In the seminal work by <a href="https://arxiv.org/pdf/1412.6572.pdf">Goodfellow et al.</a>, it is shown that a deep learning model trained for image recognition can be fooled by making minimal changes to the original image. In this example, as you can see the model classifies an image of a Panda as a Gibbon, even though the two images (original:left and modified:right) are indistinguishable to the naked eye. From that point on-wards, many researchers have identified ways to <a href="https://nvlpubs.nist.gov/nistpubs/ir/2019/NIST.IR.8269-draft.pdf?ref=https://githubhelp.com">exploit weaknesses in Artificial Intelligence (AI)</a>.</p> <p>This growing concern is specifically important for AI used in the cybersecurity domain, because if models can be fooled then it would be possible for an attacker to engineer methods in evading automated threat detection. Thereby wrecking havoc without a care of being caught.</p> <p>So today I will be talking about our own contribution towards Adversarial AI in the application of anomaly detection from distributed system logs. In this work, we put on the hat of an attacker, where our goal was to find an automated method that can evade anomaly detection by even state-of-the-art system log anomaly detection models such as <a href="https://www.cs.utah.edu/~lifeifei/papers/deeplog.pdf">DeepLog</a>. I won’t be describing minute details about our attack method, instead I will provide an overview of the design of our attack. For algorithmic details, please refer to our <a href="https://www.dinalherath.com/papers/2021codaspy.pdf">paper</a> and the <a href="https://github.com/dherath/Log_Anomaly_Mask">code</a>.</p> <h4 id="1-anomaly-detection-from-distributed-system-logs">1. Anomaly Detection from Distributed System Logs</h4> <p><img src="/material/2021/post_15/log_anomaly_detection_example.jpeg?raw=true" alt="anomaly-detection" width="600px" /> <br /></p> <p>Anomaly detection using distributed system logs usually occur in two steps–1) a parsing step and 2) a detection step. First the logs generated by the distributed system are collected and converted into numeric values called <strong>logkeys</strong>. Unlike in typical Natural Language Processing (NLP) tasks, logs generated by systems have predefined templates, as such it is possible to assign some numeric identifier for each log type.</p> <p>Therefore, a stream of logs generated can be converted into a time series with numeric values. In the above image it is denoted by \(X = \{ x_{T}, ..., x_{t}, x_{t-1}, x_{t-2}, ..., x_{0}\}\) for a time series of $T$ values where each \(x_{t}\) corresponds to the log event that occurred at time \(t\). After that, the logkeys are sent to some anomaly detection model. The anomaly detection model processes the logkey stream and detect anomalies in a sliding window format using a window of \(n\) logkeys with a step-size of 1 value per time step.</p> <h4 id="2-our-attack-log-anomaly-mask-lam">2. Our Attack: Log-Anomaly-Mask (LAM)</h4> <p><img src="/material/2021/post_15/LAM_image.jpg?raw=true" alt="lam" width="600px" /> <br /></p> <p>Here, I will go through our proposed attack, which is called <strong>Log Anomaly Mask</strong> (LAM) and an example of its working. LAM operates by intercepting the logkeys streamed towards the anomaly detection model. LAM works in two stages, first, it observes a fixed sequence of the logkeys denoted by the <strong>observation window</strong> as in the image above. Then, LAM uses a <strong>surrogate anomaly detection model</strong> to identify if there are any potential anomalies in the observed logkey window. Afterthat, in the second step, if any potential anomalies are identified in the earlier step LAM uses a component called the <strong>perturber</strong> to intercept and change the most recent observed logkey (\(x_{t}\) at time \(t\)).</p> <p>We use deep reinforcement learning to design the perturber. Because, for this attack to work, LAM should be able to intercept and attack in real-time, owing to the fact that anomaly detection models can process and detect anomalies in an online manner. Additionally, there may be many possible combinations for modifications to \(x_{t}\), but not all of them can fool the anomaly detection model. So LAM should be able to directly identify some type of modification that fools the anomaly detection model without the luxury of trying many attack combinations.</p> <p>It is possible to train a reinforcement learning agent to learn an optimal policy for identifying what’s the most likely perturbation to \(x_{t}\) so that anomaly detection fails later on. Additionally, in this attack setting LAM must make a split second attack decision while not knowing future variations in the logs that it hasn’t seen yet. Reinforcement learning agents are designed to work in partially observable environments, like deciding a move in a game even though it may not know what an opponent may do in the future. Similarly, we design our agent to fool some anomaly detection model even though it doesn’t know the variation in future logs. Please refer our <a href="https://www.dinalherath.com/papers/2021codaspy.pdf">paper</a> if you want to know an in-depth working of our attack.</p> <h5 id="an-attack-example">An Attack Example:</h5> <p><img src="/material/2021/post_15/log_attack_example.jpeg?raw=true" alt="attack-example" width="660px" /> <br /></p> <p>The example above is an attack on a distributed workflow that is designed to diagnose a patients’ illness. There are five automated tasks that are carried out for this diagnosis (i.e., T1-Feature-Extraction,…,T5-Diagnosis-Recommendation). Lets say an attacker modifies this workflow by adding some task that intercepts the result from T2 and modifies it before it arrives at T3. In the original logs before the attack you can see that variation in the structure of the workflow has changed corresponding to this attack (highlighted in red). And when these logs are processed by an anomaly detection model, it is possible to identify the presence of the attack. However, after LAM is used, the logs pertaining to the attack are modified to values that indicate an idle state of the distributed machines, which in turn fool the operational anomaly detection model. For more in-depth details please check our <a href="https://www.dinalherath.com/papers/2021codaspy.pdf">paper</a> and the <a href="https://github.com/dherath/Log_Anomaly_Mask">code</a>.</p> <h5 id="so-until-next-time">So until next time,</h5> <h5 id="cheers">Cheers!</h5> <p><strong>Next: <a href="/2022/cfgexplainer/">Explaining Graph Neural Network (GNN)-based Malware Classification</a></strong> <br /> <strong>Prev: <a href="/2020/autoencoder/">Anomaly detection with Deep AutoEncoders</a></strong></p> <aside class="share"> <p>If you liked this article and think others should read it, please <a href="http://twitter.com/share?text=Fooling AI-based System Log Anomaly Detection&amp;url=http://dinalherath.com/2021/lam/&amp;via=" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">share it on Twitter <i class="fa fa-twitter" aria-hidden="true" style="color:#00aced"></i></a> or <a href='https://www.facebook.com/sharer/sharer.php?u='+url; onclick="window.open(this.href, 'sharer', 'toolbar=0,status=0,width=550,height=235');return false;">Facebook <i class="fa fa-facebook-square" aria-hidden="true" style="color:#3b5998"></i></a>.</p> </aside> </div> </article> <!-- --> <footer class="site-footer"> <!--<link rel="stylesheet" href="/assets/icons/academicons-1.8.0/css/academicons.css"/>--> <div class="container"> <small class="block"><!--&lt;/&gt; <a href="http://github.com/heiswayi/thinkspace" title="a minimalist Jekyll theme for technical writing">Thinkspace theme</a> by <a href="http://heiswayi.github.io">Heiswayi Nrird</a>. |--><i class="fa fa-copyright"></i> 2017-2023 Jerome Dinal Herath</small> <!-- <a href="mailto:dinal.bing@gmail.com"><i class="fa fa-envelope" style="font-size:21px;color:#F15B3D;"></i></a> --> <!-- <a href="https://www.facebook.com/dinalHerath" target="_blank"><i class="fa fa-facebook-square" style="font-size:22px;color:#F15B3D"></i></a> --> <a href="https://github.com/dherath" target="blank"><i class="fa fa-github-square" style="font-size:22px;color:#F15B3D"></i></a> <a href="https://www.linkedin.com/in/jerome-dinal-herath-bba3b0148/" target="blank"><i class="fa fa-linkedin-square" style="font-size:22px;color:#F15B3D"></i></a> <a href="https://scholar.google.com/citations?user=vNtiUMwAAAAJ&hl=en" target="blank"><i class="fa fa-google" style="font-size:22px;color:#F15B3D"></i></a> <!-- <a href="/feed.xml" target="_blank"><i class="fa fa-rss-square" style="font-size:22px;color:#F15B3D"></i></a> --> <!--<a href="https://www.researchgate.net/profile/Jerome_Dinal_Herath" target="blank"> <i style="font-size:20px;color:#F15B3D;font-weight:bold;"> RG </i></a> --> </div> </footer> </main> </body> </html>
