---
layout: post
title: "Making TA-life easier: Bash scripts for grading"
comments: false
description: "post 11"
keywords: "phd, grading, TA, github, bash"
---

![phd-comics](http://phdcomics.com/comics/archive/phd051910s.gif){:width="680px"}

Hi All! today I thought of writing about something that relates to being a **Teaching Assistant** or a **TA**. To anyone who is pursuing a PhD, TA-ing is a necessary but sometimes (_cough_ most of the time) cumborsome task, that sort of comes with the job. To anyone who doesn't know much about--well what it's like pursuing a PhD, think of it as a kind of an apprentiship. We (PhD candidates) choose a professor to be our mentor and we essentially work under him/her and eventually (_cough_ hopefully) make a meaningfull contribution to our field at which point we are given the title of a **Honarary Doctorate**. 

While phd candidates are measured on their contribution to the field, most candidates get a stipend during this time which helps us stay afloat financially (_cough_ barely). This stipend either comes as a **Reasearch Assitanship** where we get paid for helping out with research work _or_ as a **Teaching Assistantship** where we help out with teaching and grading. As a Computer Science PhD candidate most of the grading I've done involves coding assignments and projects. So to make my life easier I made some **bash** scripts to automate the process a bit and thought of sharing it with everyone else. 

>
To cut it short, if you are a TA that needs to grade _programming assignments or projects_ this will really help you out. I have provided some **bash** scripts to download code from [github-classroom](https://classroom.github.com), code to check late submissions (or other repo information) and a script to crawl through all repositories/folders and run a students code.

#### Script 1: cloning Github classroom repositories

```sh
#!/bin/bash

declare -a count=1
# github IDs for all students
declare -a names=()
#the github source link, eg:- https://XXX@github.com/Repo-Name
github=""

echo " clone started"
for gitsource in "${names[@]}"
do
    echo "------------------------------------------"
    echo "($count) : $gitsource"
    count=$((count+1))
    git clone "$github-$gitsource.git"
done
```


#### Script 2: checking commit times and submission info

```sh
#!/bin/bash

declare -a count=1
# github user IDs, each entry in the list should be in ""
declare -a namesTag=()
# university email IDs (I am assuming each student will have
# some email ID they use associated with the github account)
declare -a names=()

# -- initializing variables
declare -i h=3600
declare -i difference=0
declare -i timeV=0
declare -i firstTime=0
declare -i lastTime=0
IFS=$'\n' #makes new line the only seperator

# change the course name accordingly
# eg CS-XXX
courseName='course-1'

for ((i=0;i<${#names[@]};++i))
do
    gitsource="${names[i]}"
    foldersource="${namesTag[i]}"
    #now the code will cd to CS-XXX-studentName
    cd $(pwd)/$courseName-$foldersource/
    sshKey="$(git log --author="$gitsource" --pretty=format:%H | sed -n 1p)"
    firstTime="$(git log --author=$gitsource --reverse --pretty=format:%at | sed -n 1p)"
    lastTime="$(git log --author=$gitsource --pretty=format:%at | sed -n 1p)"
    lastCommitTime="$(git log --author=$gitsource --pretty=format:%aD | sed -n 1p)"
    emailAdd="$(git log --author=$gitsource --pretty=format:%ae | sed -n 1p)"
    nocommits="$(git shortlog --author=$gitsource -s -n)"
    difference=$(($lastTime-$firstTime))
    timeV=$(($difference/$h))
    cd ..
    echo "($count) :  $nocommits - $foldersource| $emailAdd | ssh: $sshKey | commit-diff(h): $timeV | last-commit: $lastCommitTime"
    count=$((count+1))
done
```

#### Script 3: running students code

```bash
#!/bin/bash

declare -a count=1
# git IDs of students
declare -a namesTag=()
declare -i lastTime=0
IFS=$'\n' #makes new line the only seperator
echo "started"
projectName="lab06" #or anything you are grading

for ((i=0;i<${#namesTag[@]};++i))
do
	foldersource="${namesTag[i]}"
    echo "$count : start run for $foldersource (y/n) ?"
    read value
    if [ "$value" == "y" ]
    then
    	echo "runnnig ..."
    	cd $(pwd)/$projectName-$foldersource/
    	make
    	echo "----- re-run for $foldersource (y-yes/n-next):"
    	read input
    	while [ $input == "y" ]
    	do
    		echo "re-running..."
    		make
    		echo "----- re-run for $foldersource (y-yes/n-next):"
    		read input
    	done
    	echo "running finished"
    	make clean
    	cd ..
    	echo "--------------------------------------------------------------------------------"
    else
    	exit 1
    fi
    echo "moving on..."
    count=$((count+1))
done
```

##### So until next time,
##### Cheers!

**Prev: [Adding git support to Terminal]({{site.url}}/2018/git-support/)**
